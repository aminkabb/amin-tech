<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amin Tech | Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #f8fafc; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 4px; }

        .video-container { position: relative; padding-bottom: 56.25%; background: #000; border-radius: 12px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .video-placeholder { position: absolute; inset: 0; background: linear-gradient(to bottom right, #0f172a, #1e293b); display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 10; }
        
        .playlist-item { border-right: 4px solid transparent; transition: all 0.2s; }
        .playlist-item:hover { background-color: #1e293b; }
        .playlist-item.active { background-color: #1e293b; border-right-color: #ef4444; }
        
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob { animation: blob 7s infinite; }
    </style>
</head>
<body class="text-slate-800">

    <div id="video-overlay" class="fixed inset-0 bg-slate-900 z-[100] hidden flex flex-col fade-in">
        <div class="bg-slate-950 text-white p-4 flex justify-between items-center border-b border-slate-800 shadow-lg">
            <div class="flex items-center gap-3">
                <button onclick="closePlayer()" class="bg-slate-800 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition flex items-center gap-2 text-sm font-bold border border-slate-700">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
                    Ø®Ø±ÙˆØ¬
                </button>
                <h2 id="course-title-display" class="text-lg font-bold text-slate-200 border-r border-slate-700 pr-4 mr-4">...</h2>
            </div>
            <div class="text-blue-500 font-bold text-xl tracking-tighter">Amin<span class="text-white">Tech</span> Player</div>
        </div>

        <div class="flex-1 overflow-hidden flex flex-col lg:flex-row">
            <div class="flex-1 bg-black flex flex-col relative overflow-y-auto">
                <div class="p-4 lg:p-8 flex-1 flex flex-col justify-center">
                    <div class="video-container w-full max-w-5xl mx-auto border border-slate-800">
                        <div id="player-placeholder" class="video-placeholder">
                            <h3 class="text-xl font-bold mb-1">Ø§Ø®ØªØ± Ø¯Ø±Ø³Ø§Ù‹ Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©</h3>
                        </div>
                        <iframe id="main-frame" class="hidden" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                </div>
                <div class="bg-slate-900 text-white p-6 border-t border-slate-800">
                    <h1 id="video-title-display" class="text-2xl font-bold mb-2 text-blue-400">...</h1>
                    <p id="video-desc-display" class="text-slate-400 text-sm leading-relaxed">...</p>
                </div>
            </div>
            <div class="w-full lg:w-96 bg-slate-950 border-r border-slate-800 flex flex-col h-full lg:h-auto">
                <div class="p-4 bg-slate-900 border-b border-slate-800">
                    <h3 class="text-white font-bold">Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø¯ÙˆØ±Ø©</h3>
                </div>
                <div id="playlist-items" class="flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar"></div>
            </div>
        </div>
    </div>

    <nav class="bg-white/90 backdrop-blur shadow-sm sticky top-0 z-40 border-b border-slate-100">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-20 items-center">
                <span class="text-3xl font-black text-blue-900 tracking-tighter">Amin<span class="text-red-600">Tech</span></span>
                <div class="hidden md:flex gap-8">
                    <a href="#home" class="font-bold text-slate-600 hover:text-blue-900 transition">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    <a href="#courses" class="font-bold text-slate-600 hover:text-blue-900 transition">Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
                    <a href="#contact" class="bg-red-600 text-white px-6 py-2 rounded-full font-bold hover:bg-red-700 transition shadow-lg">Ø§Ø·Ù„Ø¨ Ù…Ø´Ø±ÙˆØ¹Ùƒ</a>
                </div>
            </div>
        </div>
    </nav>

    <section id="home" class="relative bg-gradient-to-br from-blue-900 to-slate-900 py-32 overflow-hidden">
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
        <div class="max-w-7xl mx-auto px-4 relative z-10 text-center">
            <h1 class="text-5xl md:text-7xl font-black text-white mb-6 leading-tight">
                Ù†Ø­ÙˆÙ„ Ø£ÙÙƒØ§Ø±Ùƒ Ø¥Ù„Ù‰ <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-red-500">ÙˆØ§Ù‚Ø¹ Ø±Ù‚Ù…ÙŠ</span>
            </h1>
            <p class="text-blue-100 text-xl max-w-2xl mx-auto mb-10">Ø´Ø±ÙŠÙƒÙƒ Ø§Ù„ØªÙ‚Ù†ÙŠ Ù„ØªØ·ÙˆÙŠØ± Ø¨Ø±Ù…Ø¬ÙŠØ§Øª Ø§Ù„ÙˆÙŠØ¨ØŒ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.</p>
        </div>
    </section>

    <section id="courses" class="py-24 bg-slate-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-black text-slate-800 mb-4">Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
                <div class="h-1 w-20 bg-red-500 mx-auto rounded-full"></div>
            </div>
            <div id="loader" class="text-center py-20"><div class="w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto"></div></div>
            <div id="courses-grid" class="grid md:grid-cols-3 gap-8 hidden"></div>
        </div>
    </section>

    <section id="contact" class="py-24 bg-white relative">
        <div class="max-w-4xl mx-auto px-4">
            <div class="bg-slate-900 rounded-3xl p-8 md:p-12 shadow-2xl relative text-center">
                <h2 class="text-3xl font-black text-white mb-4">Ø§Ø·Ù„Ø¨ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¢Ù†</h2>
                <p class="text-slate-400 mb-8">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„Ø£Ø³ÙÙ„ ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ</p>
                
                <form id="hire-form" class="space-y-4 max-w-2xl mx-auto">
                    <div class="grid md:grid-cols-2 gap-4">
                        <input type="text" id="clientName" required class="w-full px-5 py-3 rounded-xl bg-slate-800 border border-slate-700 text-white placeholder-slate-400 focus:outline-none focus:border-red-500" placeholder="Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
                        <input type="tel" id="clientPhone" required class="w-full px-5 py-3 rounded-xl bg-slate-800 border border-slate-700 text-white placeholder-slate-400 focus:outline-none focus:border-red-500" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                    </div>
                    <select id="serviceType" class="w-full px-5 py-3 rounded-xl bg-slate-800 border border-slate-700 text-white focus:outline-none focus:border-red-500 cursor-pointer">
                        <option value="Web">ØªØ·ÙˆÙŠØ± ÙˆÙŠØ¨</option>
                        <option value="Mobile">ØªØ·ÙˆÙŠØ± Ù…ÙˆØ¨Ø§ÙŠÙ„</option>
                        <option value="AI">Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</option>
                        <option value="Other">Ø£Ø®Ø±Ù‰</option>
                    </select>
                    <textarea id="projectDetails" rows="4" required class="w-full px-5 py-3 rounded-xl bg-slate-800 border border-slate-700 text-white placeholder-slate-400 focus:outline-none focus:border-red-500" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹..."></textarea>
                    
                    <button type="submit" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-4 rounded-xl transition shadow-lg transform active:scale-95">
                        Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ğŸš€
                    </button>
                </form>

                <div id="form-msg" class="hidden mt-6 text-green-400 font-bold bg-green-900/20 py-3 rounded-lg border border-green-900">
                    âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-slate-950 text-slate-400 py-12 border-t border-slate-900 text-center">
        <h3 class="text-2xl font-black text-white mb-4">Amin<span class="text-red-600">Tech</span></h3>
        <p class="text-sm">Â© 2025 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCI49mQ4v0xRO1RsbiAD23VLZEvzqZI3IE",
            authDomain: "myquizapp-f2686.firebaseapp.com",
            projectId: "myquizapp-f2686",
            storageBucket: "myquizapp-f2686.firebasestorage.app",
            messagingSenderId: "351586926960",
            appId: "1:351586926960:web:53182b527996af6fd9cfb5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        let allVideos = [];

        signInAnonymously(auth).then(() => { loadCourses(); });

        // --- Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª ---
        async function loadCourses() {
            const grid = document.getElementById('courses-grid');
            const loader = document.getElementById('loader');
            try {
                const q = query(collection(db, "courses"));
                const snap = await getDocs(q);
                let html = '';
                snap.forEach(doc => {
                    const data = doc.data();
                    // Ù†Ù…Ø±Ø± Ø§Ù„Ù€ id ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ÙØªØ­
                    html += `
                    <div class="bg-white rounded-2xl shadow-lg border border-slate-100 overflow-hidden flex flex-col">
                        <div class="relative h-52 bg-slate-200">
                            <img src="${data.image}" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/500x300?text=Course'">
                            <span class="absolute top-4 right-4 bg-blue-600 text-white text-xs px-3 py-1 rounded-full font-bold shadow-lg z-10">${data.category || 'Course'}</span>
                        </div>
                        <div class="p-6 flex flex-col flex-1">
                            <h3 class="text-xl font-black text-slate-800 mb-2">${data.title}</h3>
                            <p class="text-slate-500 text-sm mb-6 flex-1">${data.desc || ''}</p>
                            <button onclick="openPlayer('${data.id}', '${data.title}')" class="w-full py-3 rounded-xl bg-slate-900 text-white font-bold hover:bg-red-600 transition shadow-lg flex items-center justify-center gap-2">
                                Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
                            </button>
                        </div>
                    </div>`;
                });
                grid.innerHTML = html || '<div class="col-span-3 text-center text-slate-500">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙˆØ±Ø³Ø§Øª.</div>';
                loader.classList.add('hidden');
                grid.classList.remove('hidden');
            } catch (e) { console.error(e); }
        }

        // --- Ø¯Ø§Ù„Ø© ÙØªØ­ Ø§Ù„Ù…Ø´ØºÙ„ (Ø¨Ø§Ù„ÙÙ„ØªØ±Ø©) ---
        window.openPlayer = async function(courseId, courseTitle) {
            document.getElementById('video-overlay').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            document.getElementById('course-title-display').innerText = courseTitle;
            const list = document.getElementById('playlist-items');
            list.innerHTML = '<div class="text-center py-10 text-slate-400">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¯Ø±ÙˆØ³...</div>';

            try {
                // Ø§Ù„ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ courseId
                let q;
                if(courseId) {
                    q = query(collection(db, "videos"), where("courseId", "==", courseId));
                } else {
                    q = query(collection(db, "videos"));
                }

                const snap = await getDocs(q);
                allVideos = [];
                snap.forEach(doc => allVideos.push(doc.data()));

                if (allVideos.length === 0) {
                    list.innerHTML = `<div class="text-center py-10 px-4 text-slate-500">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ±Ø³.</div>`;
                } else {
                    list.innerHTML = allVideos.map((vid, idx) => `
                        <div onclick="playVideo(${idx})" class="playlist-item p-4 flex gap-3 cursor-pointer group rounded-lg mx-2 my-1 border border-slate-800/50 hover:bg-slate-800">
                            <div class="flex-1 min-w-0">
                                <h4 class="text-slate-300 font-bold text-sm line-clamp-2 group-hover:text-white transition">â–¶ ${vid.title}</h4>
                                <span class="text-xs text-slate-600 mt-1 block">â± ${vid.duration || '00:00'}</span>
                            </div>
                        </div>
                    `).join('');
                }
            } catch(e) { console.error(e); }
        };

        // --- Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ---
        function getEmbedUrl(url) {
            if (!url) return "";
            if (url.includes("youtube.com") || url.includes("youtu.be")) {
                const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
                const match = url.match(regExp);
                const vidId = (match && match[2].length === 11) ? match[2] : null;
                return vidId ? `https://www.youtube.com/embed/${vidId}?autoplay=1` : "";
            }
            if (url.includes("drive.google.com")) {
                return url.replace(/\/view.*/, "/preview").replace(/\/file\/d\/(.*?)\/.*/, "/file/d/$1/preview");
            }
            return url;
        }

        // --- Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ---
        window.playVideo = function(idx) {
            const vid = allVideos[idx];
            if(!vid) return;
            const frame = document.getElementById('main-frame');
            const placeholder = document.getElementById('player-placeholder');
            document.getElementById('video-title-display').innerText = vid.title;
            document.getElementById('video-desc-display').innerText = vid.desc || '';
            document.querySelectorAll('.playlist-item').forEach((el, i) => {
                if(i === idx) el.classList.add('active'); else el.classList.remove('active');
            });
            const finalLink = getEmbedUrl(vid.youtubeId);
            if(finalLink) {
                frame.src = finalLink;
                frame.classList.remove('hidden');
                placeholder.classList.add('hidden');
            } else {
                frame.src = "";
                frame.classList.add('hidden');
                placeholder.classList.remove('hidden');
            }
        };

        window.closePlayer = function() {
            document.getElementById('video-overlay').classList.add('hidden');
            document.body.style.overflow = 'auto';
            document.getElementById('main-frame').src = '';
        };

        // --- (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨) Ù…Ù†Ø·Ù‚ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ---
        document.getElementById('hire-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const msg = document.getElementById('form-msg');
            const btn = e.target.querySelector('button');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„... â³";
            btn.disabled = true;
            btn.classList.add('opacity-50');
            
            try {
                await addDoc(collection(db, "service_requests"), {
                    name: document.getElementById('clientName').value,
                    phone: document.getElementById('clientPhone').value,
                    service: document.getElementById('serviceType').value,
                    details: document.getElementById('projectDetails').value,
                    timestamp: serverTimestamp()
                });
                msg.classList.remove('hidden');
                e.target.reset();
                setTimeout(() => {
                    msg.classList.add('hidden');
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                    btn.classList.remove('opacity-50');
                }, 5000);
            } catch(err) {
                console.error(err);
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
                btn.innerHTML = originalText;
                btn.disabled = false;
                btn.classList.remove('opacity-50');
            }
        });
    </script>
</body>
</html>